# Example gRPC + ZeroMQ + SSE using C++

## Important notes

1. Install cmake via installer from https://cmake.org/download/ and add  ```/path/to/CMake/bin ``` to your path environment
   
2. Install vcpkg via clone, https://vcpkg.io/en/getting-started
   
3. Open cmd in vcpkg folder, install protobuf, grpc, zlib

    ```
    vcpkg install protobuf protobuf:x64-windows
    ```
    
    ```
    vcpkg install grpc
    ```
    
    ```
    vcpkg install protobuf[zlib] protobuf[zlib]:x64-windows
    ```
    
    ```
    vcpkg integrate install
    ```
    
    >**Important**
    
    Put all ```find_packages``` and ```target_link_libraries``` in CMakeLists.txt
    
    Add ```"path/to/vcpkg/installed/x64-windows/include"``` to ```.vscode/c_cpp_properties.json``` inside includePath

4. Install protobuf locally via download and extract from https://github.com/protocolbuffers/protobuf/releases and add  ```path/to/protoc-{VERSION}-win64/bin``` to your path environment 

    >**Important**
    
    Make sure that protobuf version on  ```/path/to/vcpkg/packages/protobuf_x64-windows/include/google/protobuf/stubs```
    
    ```
    #define GOOGLE_PROTOBUF_VERSION 3021012
    ```

    is the same version on .pb.h to prevent error when build the app
    
    ```
    #include <google/protobuf/port_def.inc>
    #if PROTOBUF_VERSION < 3021000
    #error This file was generated by a newer version of protoc which is
    #error incompatible with your Protocol Buffer headers. Please update
    #error your headers.
    #endif
    #if 3021003 < PROTOBUF_MIN_PROTOC_VERSION
    #error This file was generated by an older version of protoc which is
    #error incompatible with your Protocol Buffer headers. Please
    #error regenerate this file with a newer version of protoc.
    #endif
    ```

5. Generate all required cpp file from .proto 

    go to ```protos``` directory

    ```
    cd src/protos
    ```

    generate cpp file from .proto
    ```
    protoc -I ./ --grpc_out=../generated_protos --plugin=protoc-gen-grpc=/path/to/vcpkg/packages/grpc_x64-windows/tools/grpc/grpc_cpp_plugin.exe user.proto
    protoc -I ./ --cpp_out=../generated_protos user.proto
    ```
6. Install ZeroMQ with vcpkg

    ```
    vcpkg install cppzmq
    ```
    
7. Install Nlohmann-JSON & Rapid-JSON

    ```
    vcpkg install nlohmann-json
    ```

    ```
    vcpkg install rapidjson
    ```

8. Install PQXX for Postgresql Database
    ```
    vcpkg install libpqxx
    ```

9. Install restbed for SSE server
    ```
    vcpkg install restbed
    ```
    
10. Adjust environment in .env

